<div class="m-5">
    <div class="d-flex  flex-row-reverse">
        <button onclick="show_addmodal()" id="id-drug-add" class="rounded-5 btn btn-sm btn-outline-success w-25"><i
                class="fa fa-plus-circle"></i> Group</button>
        <div class="form-generic me-5 d-flex flex-row">
            <input type="text" placeholder="Search" class="form-control bg-success bg-opacity-10 form-control-sm text-center border-0 rounded">
            <button type="submit" class="btn bg-success bg-opacity-25 btn-sm rounded-3"><i class="fas fa-search"></i>
            </button>
        </div>
        <span class="text-lg-start me-5 text-success " id="the_delivery_guy">
            <%=msg%>
        </span>
    </div>
    <table style="width: 100%" class="mt-3 rounded-3">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Group Name</th>
                <th scope="col">Update</th>
                <th scope="col">Delete</th>
            </tr>
        </thead>
        <tbody>
            <% for (let i=0;i<groups.length;i++) { %>
                <tr style="height: 30px; " class="border border-bottom-1 ">
                    <th scope="row">
                        <%=i+1%>
                    </th>
                    <td>
                        <%=groups[i].name %>
                    </td>
                    <td>
                        <button onclick="show_editmodal(`<%=groups[i].name %>`,`<%=groups[i].id %>`)" class="btn btn-sm btn-outline-info " style="font-size: 11px; ">
                            <i class="fas fa-pen "></i></button>
                    </td>
                    <td>
                        <button onclick="show_dltmodal(`<%=groups[i].name %>`,`<%=groups[i].id %>`)" class="btn btn-sm btn-outline-danger " style="font-size: 11px; "> <i
                                class="fas fa-trash "></i></button>
                    </td>
                </tr>
                <% } %>
        </tbody>
    </table>
    <div id="dlt-modal" class="modal mt-5 rounded">
        <div class="modal-dialog " role="document ">
            <div class="modal-content ">
                <div class="modal-body pb-4">
                    <form action="/groups/dlt" method="DELETE">
                        <input type="hidden" id="dlt_grp_pagenumb" name="pagenumb" value=<%=skip / limit + 1%> >
                        <input hidden type="text" id="dlt_grpid" value="" name="grpid" />
                        <h5 class="h4 mb-4 border-bottom border-2 border-warning">Sure About Deletion ? </h3>
                            <button type="submit" class="float-end btn btn-sm btn-info w-25 rounded text-start">Delete</button>
                    </form>
                    <button onclick="document.getElementById('dlt-modal').style.display='none'" class="float-start btn btn-sm btn-warning w-25 rounded text-start "> Cancel </button>
                </div>
            </div>
        </div>
    </div>
    <div id="edt-modal" class="modal mt-5 rounded ">
        <div class="modal-dialog " role="document ">
            <div class="modal-content ">
                <div class="modal-header ">
                    <h5 class="modal-title ">Update Group</h5>
                    <button class="btn btn-warning " onclick="document.getElementById( 'edt-modal').style.display='none' ">
                        <i class="fa fa-times-circle " aria-hidden="true "></i>
                    </button>
                </div>
                <div class="modal-body ">
                    <form class="text-start" action="/groups/edt" method="POST">
                        <input type="hidden" id="edt_grp_pagenumb" name="pagenumb" value=<%=skip / limit + 1%> >
                        <input hidden id="edt_grpid" value="" name="grpid" />
                        <label for="grpname" class="form-label ">Name:</label>
                        <input id="edt_grpname" type="text " class="form-control " required name="grpname">
                        <button type="submit" class="btn btn-sm btn-info mt-4 mb-3 w-50 rounded ">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div id="add-modal" class="modal mt-5 ">
        <div class="modal-dialog " role="document ">
            <div class="modal-content ">
                <div class="modal-header ">
                    <h5 class="modal-title ">New Group</h5>
                    <button class="btn btn-warning " onclick="document.getElementById( 'add-modal').style.display='none' ">
                        <i class="fa fa-times-circle " aria-hidden="true "></i>
                    </button>
                </div>
                <div class="modal-body ">
                    <form class="text-start " action="/groups" method="POST">
                        <input type="hidden" id="add_grp_pagenumb" name="pagenumb" value=<%=skip / limit + 1%> >
                        <label for="grpname" class="form-label ">Name:</label>
                        <input type="text" class="form-control " required name="grpname" placeholder="ex: Tablet ">
                        <button class="btn btn-sm btn-outline-info mt-4 w-100 ">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="pt-3">
        <div class="border-1 text-start">
            <form id="grp_pagenumbform" action="/groups" method="get">
                <span class=" text-success text-start text-capitalize">Total <%=Math.ceil(count/limit)%> Pages; <%=count%> Generics</span>
                <span class="text-success ms-2">
                    <strong>Go to page</strong>
                </span>
                <input id="grp_pagenumb" onchange="pageNumbSubmit()" name="pagenumb" type="number" style="width: 45px;height: 28px;" class="border-start border-end text-center d-inline" value=<%=skip / limit + 1%> >
            </form>
        </div>
    </div>

    <script>
        function pageNumbSubmit() {
            console.log(document.getElementById('grp_pagenumb').value)
            if (document.getElementById('grp_pagenumb').value > 0) {
                document.getElementById("grp_pagenumbform").submit();
            }
        }

        function pageUp() {
            document.getElementById('grp_pagenumb').value = Number(document.getElementById('grp_pagenumb').value) + 1
        }

        function pageDown() {
            if (document.getElementById('grp_pagenumb').value > 1) {
                document.getElementById('grp_pagenumb').value = Number(document.getElementById('grp_pagenumb').value) - 1
            }
        }
        let tobeDeleted = {}

        function show_addmodal() {
            document.getElementById('add-modal').style.display = 'block'
        }

        function show_dltmodal(grpName, idGrp) {
            tobeDeleted.grpName = grpName;
            tobeDeleted.id = idGrp;
            document.getElementById('dlt_grpid').value = idGrp
            document.getElementById('dlt-modal').style.display = 'block'

        }

        function show_editmodal(grpname, idGrp) {
            tobeDeleted.grpName = grpname;
            tobeDeleted.id = idGrp;
            document.getElementById("edt_grpname").value = grpname;
            document.getElementById('edt_grpid').value = idGrp
            document.getElementById('edt-modal').style.display = 'block'

        }

        function deleteReqSender(url, reqMethod, data) {
            console.log("????? " + url, reqMethod, data)
            fetch("/groups/pok ", {
                method: 'POST',
                body: JSON.stringify(data),
                headers: {
                    'Content-type': 'application/json',
                }
            }).then(res => {
                console.log("hype lover :: " + res[0])
                location.reload()
            }).catch(err => {
                console.log(err)
            })
        }

        setTimeout(() => {
                const idmsg = "the_delivery_guy";
                document.getElementById(idmsg).innerHTML = " "
            }, 3000)
            // Get the modal
        window.onclick = function(event) {
            let addmodal = document.getElementById('add-modal');
            let edtmodal = document.getElementById('edt-modal')
            let dltmodal = document.getElementById('dlt-modal')
            if (event.target == addmodal) {
                addmodal.style.display = "none ";
            }
            if (event.target == edtmodal) {
                edtmodal.style.display = "none ";
            }
            if (event.target == dltmodal) {
                dltmodal.style.display = "none ";
            }
        }
    </script>
</div>